"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[969],{3905:function(e,t,n){n.d(t,{Zo:function(){return p},kt:function(){return h}});var a=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function r(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var l=a.createContext({}),d=function(e){var t=a.useContext(l),n=t;return e&&(n="function"==typeof e?e(t):s(s({},t),e)),n},p=function(e){var t=d(e.components);return a.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,l=e.parentName,p=r(e,["components","mdxType","originalType","parentName"]),m=d(n),h=i,u=m["".concat(l,".").concat(h)]||m[h]||c[h]||o;return n?a.createElement(u,s(s({ref:t},p),{},{components:n})):a.createElement(u,s({ref:t},p))}));function h(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,s=new Array(o);s[0]=m;var r={};for(var l in t)hasOwnProperty.call(t,l)&&(r[l]=t[l]);r.originalType=e,r.mdxType="string"==typeof e?e:i,s[1]=r;for(var d=2;d<o;d++)s[d]=n[d];return a.createElement.apply(null,s)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},9345:function(e,t,n){n.r(t),n.d(t,{assets:function(){return p},contentTitle:function(){return l},default:function(){return h},frontMatter:function(){return r},metadata:function(){return d},toc:function(){return c}});var a=n(7462),i=n(3366),o=(n(7294),n(3905)),s=["components"],r={sidebar_position:1,sidebar_label:"leemons"},l="Leemons package",d={unversionedId:"develop/packages/leemons",id:"develop/packages/leemons",title:"Leemons package",description:"Leemons is the main package of the application, from which the rest of the necessary packages and libraries are initialized, the server is raised and the Frontend is compiled.",source:"@site/docs/develop/packages/leemons.mdx",sourceDirName:"develop/packages",slug:"/develop/packages/leemons",permalink:"/leemons-docs/develop/packages/leemons",draft:!1,editUrl:"https://github.com/leemonade/leemons-docs/tree/main/docs/develop/packages/leemons.mdx",tags:[],version:"current",sidebarPosition:1,frontMatter:{sidebar_position:1,sidebar_label:"leemons"},sidebar:"tutorialSidebar",previous:{title:"Packages",permalink:"/leemons-docs/category/packages"},next:{title:"leemons-database",permalink:"/leemons-docs/develop/packages/leemons-database"}},p={},c=[{value:"CLI",id:"cli",level:2},{value:"Commands",id:"commands",level:3},{value:"App",id:"app",level:2},{value:"Configuration",id:"configuration",level:3},{value:"Backend Service",id:"backend-service",level:3},{value:"Frontend Service",id:"frontend-service",level:3},{value:"Models",id:"models",level:3},{value:"Plugins",id:"plugins",level:2},{value:"Controllers",id:"controllers",level:3},{value:"Services",id:"services",level:3},{value:"Models",id:"plugin-model",level:3},{value:"Frontend",id:"frontend",level:3},{value:"Providers",id:"providers",level:2},{value:"Configuration",id:"configuration-1",level:3}],m={toc:c};function h(e){var t=e.components,n=(0,i.Z)(e,s);return(0,o.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,o.kt)("h1",{id:"leemons-package"},"Leemons package"),(0,o.kt)("p",null,"Leemons is the main package of the application, from which the rest of the necessary packages and libraries are initialized, the server is raised and the Frontend is compiled."),(0,o.kt)("h2",{id:"cli"},"CLI"),(0,o.kt)("p",null,"To make it easier to use leemons, we have included a CLI (Command Line Interface), which consists of two commands."),(0,o.kt)("h3",{id:"commands"},"Commands"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"$ leemons start")," Starts the app."),(0,o.kt)("p",null,"When you start the app in production mode, you can use leemons with full functionality, but the app will not detect the changes until the process is restarted."),(0,o.kt)("p",null,"In production mode, dependencies are also installed and the Frontend is compiled (if not already compiled)."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"$ leemons dev")," Starts the app in development mode."),(0,o.kt)("p",null,"When you start the app in development mode, it starts the app in parts, in first instance it starts a process that will listen to the main changes in the app, this process in turn, starts another one that will have the application itself."),(0,o.kt)("p",null,"Master Process:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Listens for changes in the core packages."),(0,o.kt)("li",{parentName:"ul"},"Listens for changes in the app configuration"),(0,o.kt)("li",{parentName:"ul"},"When there are changes it restarts the dependent processes (workers).")),(0,o.kt)("p",null,"Worker process:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"Initializes the application configuration"),(0,o.kt)("li",{parentName:"ul"},"Listens for changes in the Frontend and starts the Front service."),(0,o.kt)("li",{parentName:"ul"},"Listens for changes in the Backend and starts the Back service.")),(0,o.kt)("p",null,"In this way, the waiting time between the changes and the app update is optimized to the maximum."),(0,o.kt)("h2",{id:"app"},"App"),(0,o.kt)("p",null,"The application consists of three parts: configuration, Frontend and Backend, each of them is started by the ",(0,o.kt)("inlineCode",{parentName:"p"},"Leemons")," class."),(0,o.kt)("p",null,"In the instantiation of the class, a ",(0,o.kt)("a",{parentName:"p",href:"https://koajs.com/"},"Koa.js")," server and two ",(0,o.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/koa-router"},"Koa-Router")," are created (one for the app in general and one for Backend). Next, it is necessary to load the configuration using the ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.loadAppConfig")," method, which will be used in both Front and Back loading."),(0,o.kt)("p",null,"Once the app configuration is loaded, it is necessary to load the configuration of the different plugins, for this, you have the method ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.loadPluginsConfig"),", and then you can start loading the Back and Front."),(0,o.kt)("p",null,"Now that all the configuration is loaded, you can load both the Back and the Front, it doesn't matter which service you load first, you can even load them at the same time: ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.loadBack")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.loadFront"),"."),(0,o.kt)("p",null,"Now everything is loaded and you can start the app with the ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.start")," method (but not before indicating that everything is loaded ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.loaded = true"),")."),(0,o.kt)("p",null,"If you don't want to worry about how the app starts inside, you can opt for the ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.load")," method which will do all these steps for you, or just ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.start")," which will detect that the app hasn't loaded yet and load it before starting it."),(0,o.kt)("h3",{id:"configuration"},"Configuration"),(0,o.kt)("p",null,"The app configuration is performed with the ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.loadAppConfig")," method, which loads all JavaScript and JSON files in the configuration folder."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"TIP")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The configuration folder can be changed using the ",(0,o.kt)("inlineCode",{parentName:"p"},"CONFIG_DIR")," environment variable, by default it will be ",(0,o.kt)("inlineCode",{parentName:"p"},"/config/"),"."))),(0,o.kt)("p",null,"You can find the configuration in ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.config"),", following the configuration folder structure:"),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"configDirectory/database.js")," -> ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.config.database"),"."),(0,o.kt)("p",null,(0,o.kt)("inlineCode",{parentName:"p"},"configDirectory/config.json")," -> ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.config.config")," -> ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.config.config"),"."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"INFO")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The configuration object is a ConfigProvider, which has the following auxiliary methods:"),(0,o.kt)("pre",{parentName:"div"},(0,o.kt)("code",{parentName:"pre",className:"language-js"},"get: (key, defaultValue) => lodash.get(config, key, defaultValue),\nhas: (key)                  => lodash.has(config, key),\nset: (key, value)           => lodash.set(config, key, value)\n")),(0,o.kt)("p",{parentName:"div"},(0,o.kt)("a",{parentName:"p",href:"https://lodash.com/docs/"},"Lodash documentation")))),(0,o.kt)("h3",{id:"backend-service"},"Backend Service"),(0,o.kt)("p",null,"The Backend service is in charge of managing the server, the application and the database. The first thing that happens is the loading of the models, once all are loaded, we proceed to initialize the ",(0,o.kt)("a",{parentName:"p",href:"leemons-database/#database-manager"},"database manager")," (stored in ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.db"),"), then, the schema specified in the database is created and finally the ORM model used in the installed ",(0,o.kt)("a",{parentName:"p",href:"leemons-database/#connectors"},"connector")," is initialized."),(0,o.kt)("p",null,"The entry point to the Backend is the API, which is accessible through the ",(0,o.kt)("inlineCode",{parentName:"p"},"https://{url}/api/{endpoint}")," endpoint. Thus exposing the different ",(0,o.kt)("a",{parentName:"p",href:"#controllers"},"controllers")," and ",(0,o.kt)("a",{parentName:"p",href:"#services"},"services"),"."),(0,o.kt)("h3",{id:"frontend-service"},"Frontend Service"),(0,o.kt)("p",null,"The Frontend service is in charge in first instance of collecting all the necessary files to load the web, it also installs the necessary dependencies and compiles the final version."),(0,o.kt)("h3",{id:"models"},"Models"),(0,o.kt)("p",null,"Models are the basic unit of a database schema. They are JSON objects interpreted in a simpler structure:"),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"All fields are populated with a default model:")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"Show the default model"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const defaultModel = {\n  modelName: name,\n  connection: leemons.config.get('database.defaultConnection'),\n  collectionName: name,\n  info: {\n    name,\n    description: '',\n  },\n  options: {\n    useTimestamps: false,\n  },\n  attributes: {},\n  primaryKey: {\n    name: 'id',\n    type: 'int',\n  },\n  type: 'collection',\n  target: 'global',\n};\n"))),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The names are standardized to avoid name repetition.")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"See standardization guide"),(0,o.kt)("p",null,"Every model is stored in ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons")," on a property based on the model's origin"),(0,o.kt)("p",null,"e.g., you have a plugin called user-administration, then your models are stored under:\n",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.plugins.user-administration.models")," and your model names and collection names will be transformed to: ",(0,o.kt)("inlineCode",{parentName:"p"},"plugins_user-administration::OriginalName"),".")),(0,o.kt)("ol",null,(0,o.kt)("li",{parentName:"ol"},"The data is structured")),(0,o.kt)("details",null,(0,o.kt)("summary",null,"See structure"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"const model = {\n  connection,\n  modelName,\n  type,\n  target\n\n  schema: { // used in schema and model creation (connector)\n    collectionName,\n    options,\n    attributes,\n    primaryKey\n  }\n\n  allAttributes: { // used in the queryBuilders\n    // All the attributes that are not many to many relations\n  }\n}\n"))),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Note")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"More information can be found in a final model as a result of a connector."))),(0,o.kt)("h2",{id:"plugins"},"Plugins"),(0,o.kt)("p",null,"Leemons works through plugins, these are a code extension, allowing to add more functionality to the Frontend or Backend. Creating a plugin is super simple, you only need to follow a structure and do the rest as usual."),(0,o.kt)("p",null,"Plugins can be installed in two ways:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"With ",(0,o.kt)("a",{parentName:"li",href:"https://www.npmjs.com"},"NPM"),". They must be NPM packages whose name is ",(0,o.kt)("inlineCode",{parentName:"li"},"leemons-plugin-{PLUGIN_NAME}"),"."),(0,o.kt)("li",{parentName:"ul"},"Create a folder inside the plugin directory with the plugin name.")),(0,o.kt)("p",null,"A plugin, depending on the services it extends, must contain some folders or others. The functionalities that a plugin can add are controllers, services, models and Frontend."),(0,o.kt)("div",{className:"admonition admonition-tip alert alert--success"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"}))),"INFO")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"All plugin code is executed in a secure environment and does not have access to the application's ",(0,o.kt)("inlineCode",{parentName:"p"},"process.env"),", but to the one specified in the plugin's ",(0,o.kt)("inlineCode",{parentName:"p"},".env"),"."),(0,o.kt)("p",{parentName:"div"},"This file is executed by Leemons in search of a JSON"))),(0,o.kt)("h3",{id:"controllers"},"Controllers"),(0,o.kt)("p",null,"The controllers are a set of functions in charge of answering a request to the API, these functions have an endpoint (API path) and a method (GET, POST, DELETE...) associated to them."),(0,o.kt)("p",null,"The controllers must be defined in the controllers folder, specified in the plugin configuration (default is ",(0,o.kt)("inlineCode",{parentName:"p"},"/plugin/controllers/"),"), inside, a ",(0,o.kt)("inlineCode",{parentName:"p"},"routes.js")," or ",(0,o.kt)("inlineCode",{parentName:"p"},"routes.json")," file specifying the different endpoints, next to this, each of the ",(0,o.kt)("inlineCode",{parentName:"p"},"controller.js")," controllers."),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"How to define an endpoint?")),(0,o.kt)("p",null,"Inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"routes")," file you must declare an array according to the route, method and controller."),(0,o.kt)("p",null,"Additionally you can specify if you need to be authenticated and if you want that only users with certain permissions can access:"),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-json"},'[\n  {\n    "path": "/user", // Receives requests at `POST /user`\n    "method": "POST",\n    "handler": "users.register" // Resolves the request with the "register" function from `controllers/users.js`\n  },\n  {\n    "path": "/user/:id", // Receives requests at `GET /user/:id`\n    "method": "GET",\n    "handler": "users.userInfo" // Resolves the request with the "userInfo" function from `controllers.users.js`\n  },\n  {\n    "path": "/user/:id", // Receives requests at `GET /user/:id`\n    "method": "DELETE",\n    "authenticated": true, // Only logged in users with an authorization token will be able to access.\n    "permissions": ["delete-users"], // Only users with the "delete-users" permission will be able to access\n    "handler": "users.delete" // Resolves the request with the "userInfo" function from `controllers.users.js`\n  }\n]\n')),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Caution")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"The specified path will not be the actual endpoint, but will resolve to the following: ",(0,o.kt)("inlineCode",{parentName:"p"},"/api/{PLUGIN_NAME}/{SPECIFIED_PATH}"),"."))),(0,o.kt)("p",null,(0,o.kt)("strong",{parentName:"p"},"What should the controller function be like?"),"."),(0,o.kt)("p",null,"The controller function, should be the same as you would use in KOA.js, it will receive a ",(0,o.kt)("a",{parentName:"p",href:"https://koajs.com/#context"},"Context")," with all the information of the request."),(0,o.kt)("div",{className:"admonition admonition-caution alert alert--warning"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 16 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"}))),"Middlewares")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Currently a plugin can't add middlewares, but we are working on it \ud83d\udc69\u200d\ud83d\udcbb"))),(0,o.kt)("h3",{id:"services"},"Services"),(0,o.kt)("p",null,"Services are a set of functions just like controllers, but intended for general use, for example, a helper function that sends an email or a helper function that calculates the final grade."),(0,o.kt)("p",null,"The services must be a JavaScript file described in the services folder (by default ",(0,o.kt)("inlineCode",{parentName:"p"},"/services/"),") and is stored in ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.plugins.{PLUGIN_NAME}.services.{FILE_NAME}"),". The content of this file is loaded in a safe environment (but is not executed if you don't do it, being able to export any kind of data)."),(0,o.kt)("h3",{id:"plugin-model"},"Models"),(0,o.kt)("p",null,"A plugin may need to use the database, for that, it can create ",(0,o.kt)("inlineCode",{parentName:"p"},"models"),", these are JSONs or JavaScripts in the models folder (by default ",(0,o.kt)("inlineCode",{parentName:"p"},"/models/"),")."),(0,o.kt)("p",null,"The specified models can be accessed via ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.plugins.{PLUGIN_NAME}.models.{MODEL_NAME}")," or via ",(0,o.kt)("inlineCode",{parentName:"p"},"leemons.query({MODEL_NAME})"),"."),(0,o.kt)("h3",{id:"frontend"},"Frontend"),(0,o.kt)("p",null,"Extending the Frontend is the simplest process, as it works as a small-scale React app in the Front folder (default ",(0,o.kt)("inlineCode",{parentName:"p"},"/frontend/"),")."),(0,o.kt)("div",{className:"admonition admonition-danger alert alert--danger"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"12",height:"16",viewBox:"0 0 12 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"}))),"TODO")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"Must document the ",(0,o.kt)("inlineCode",{parentName:"p"},"<Public>")," and ",(0,o.kt)("inlineCode",{parentName:"p"},"<Private>")," for the frontend routes."))),(0,o.kt)("p",null,"The rest of the files create them inside the ",(0,o.kt)("inlineCode",{parentName:"p"},"src")," folder and you can import them using ",(0,o.kt)("inlineCode",{parentName:"p"},"import {} from '@{PLUGIN_PLUGIN_NAME}/{PATH_D FROM_SRC}'"),"."),(0,o.kt)("h2",{id:"providers"},"Providers"),(0,o.kt)("p",null,"Providers work like a plugin but with more limitations, their goal is to extend a plugin by giving it more functionality."),(0,o.kt)("p",null,"Providers can be installed in two ways:"),(0,o.kt)("ul",null,(0,o.kt)("li",{parentName:"ul"},"With ",(0,o.kt)("a",{parentName:"li",href:"https://npmjs.com"},"NPM"),". They must be NPM packages whose name is ",(0,o.kt)("inlineCode",{parentName:"li"},"leemons-provider-{PROVIDER_NAME}"),"."),(0,o.kt)("li",{parentName:"ul"},"Create a folder inside the plugins directory with the name of the plugin.")),(0,o.kt)("p",null,"Unlike plugins a provider can only add as functionalities services and models."),(0,o.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,o.kt)("div",{parentName:"div",className:"admonition-heading"},(0,o.kt)("h5",{parentName:"div"},(0,o.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,o.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,o.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"INFO")),(0,o.kt)("div",{parentName:"div",className:"admonition-content"},(0,o.kt)("p",{parentName:"div"},"All the code of the providers is executed in a safe environment and does not have access to the process.env of the application, but to the one specified in the .env of the provider."),(0,o.kt)("p",{parentName:"div"},"This file is executed by Leemons looking for a JSON"))),(0,o.kt)("h3",{id:"configuration-1"},"Configuration"),(0,o.kt)("p",null,"The providers within their configuration file need a new field where they specify which plugin will have access to it (the provider)."),(0,o.kt)("pre",null,(0,o.kt)("code",{parentName:"pre",className:"language-js"},"module.exports = {\n  private: true,\n  pluginsCanUseMe: ['plugin-name-without-leemons-plugin-prefix'],\n};\n")))}h.isMDXComponent=!0}}]);